<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<title>Circle Testing</title>
	<script type="text/javascript" src="js/paper.js"></script>
	<script type="text/javascript" src="js/jquery-1.9.1.min.js"></script>
	<script type="text/javascript">
		window.onload = function() {
		        // Get a reference to the canvas object
	        	var canvas = document.getElementById('canvas1');
			paper.setup(canvas);
		
			var topLeft = new paper.Point(200, 200);
			var size = new paper.Size(150, 100);
			var rectangle = new paper.Rectangle(topLeft, size);
			var path = new paper.Path.Ellipse(rectangle);
			path.fillColor = '#628FCB';
		
			var topLeft = new paper.Point(5, 400);
			var size = new paper.Size(100, 50);
			var rectangle = new paper.Rectangle(topLeft, size);
			var path = new paper.Path.Ellipse(rectangle);
			path.fillColor = '#547750';
			
			var path = new paper.Path.Circle(new paper.Point(50, 50), 25);
			path.fillColor = '#ECDFC6';
			
			var timeText = new paper.PointText(new paper.Point(10, 10));
			timeText.justification = 'left';
			timeText.fillColor = 'black';

			var maxText = new paper.PointText(new paper.Point(10, 22));
			maxText.justification = 'left';
			timeText.fillColor = 'black';
			
			var countText = new paper.PointText(new paper.Point(10, 34));
			countText.justification = 'left';
			countText.fillColor = 'black';

			var prevTime = 0.0;			
			var maxTime = 0.0;
			var updateCount = 0;

			function updateTime(currentTime){
				if (prevTime != 0.0) {
					timeElapsed = currentTime - prevTime;
					if (timeElapsed > maxTime){
						maxTime = timeElapsed;
					}
				}
				prevTime = currentTime;
				var date = new Date(currentTime*1000);
				timeText.content = date.toString();

				updateCount += 1;
				
				paper.view.draw();
			}
			
			function getTime(){
				$.ajax({
					url: 'time',
					data: '',
					type: 'GET',
					dataType: 'text',
				})
				.done(updateTime)
				.always(function() {
					setTimeout(getTime, 1000);
					});
			}
			
			var tool = new paper.Tool();
			
			tool.onMouseDown = function(event){
				$.ajax({
					url: 'test',
					data: JSON.stringify(event.point),
					type: 'POST',
					dataType: 'json'
				});
			}
			getTime();
		};
	</script>
</head>
<body bgcolor="#ABDDED">
	<canvas id="canvas1" resize></canvas>
</body>
</html>
